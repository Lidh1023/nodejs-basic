# LangChain Tools çŸ¥è¯†ç‚¹è¯¦è§£

> è®© AI æ‹¥æœ‰ã€ŒåŒæ‰‹ã€â€”â€” Tools æ˜¯ LangChain ä¸­æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€

[![LangChain](https://img.shields.io/badge/LangChain-v0.3-blue)](https://js.langchain.com/)
[![Node.js](https://img.shields.io/badge/Node.js-18+-green)](https://nodejs.org/)
[![License](https://img.shields.io/badge/License-MIT-yellow)](LICENSE)

## ğŸ“– å‰è¨€

**ä½ æ˜¯å¦é‡åˆ°è¿‡è¿™äº›é—®é¢˜ï¼Ÿ**

- ğŸ¤” è®© AI æŸ¥è¯¢å®æ—¶ä¿¡æ¯ï¼Œå®ƒå´è¯´"æˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ°..."
- ğŸ¤” è®© AI åšç²¾ç¡®è®¡ç®—ï¼Œå®ƒå´ç»™å‡ºä¸€ä¸ªä¼°ç®—å€¼
- ğŸ¤” æƒ³è®© AI è°ƒç”¨ä½ çš„ APIï¼Œå´ä¸çŸ¥é“ä»ä½•ä¸‹æ‰‹

**LangChain Tools å°±æ˜¯è§£å†³è¿™äº›é—®é¢˜çš„åˆ©å™¨ï¼**

æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œç³»ç»Ÿå­¦ä¹  LangChain Tools çš„ä½¿ç”¨æ–¹æ³•ã€‚æ— è®ºä½ æ˜¯ AI å¼€å‘æ–°æ‰‹è¿˜æ˜¯æœ‰ç»éªŒçš„å¼€å‘è€…ï¼Œéƒ½èƒ½ä»ä¸­è·å¾—å®ç”¨çš„çŸ¥è¯†å’ŒæŠ€å·§ã€‚

### âœ¨ æœ¬æ–‡ç‰¹è‰²

- ğŸ“š **ç³»ç»Ÿå…¨é¢** - ä»æ¦‚å¿µåˆ°å®æˆ˜ï¼Œå¾ªåºæ¸è¿›
- ğŸ’» **ä»£ç ä¸°å¯Œ** - æ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½æœ‰å¯è¿è¡Œçš„ç¤ºä¾‹
- ğŸ”§ **çœŸå®æ¡ˆä¾‹** - åŒ…å« TavilySearch ç­‰çœŸå® API é›†æˆ
- ğŸ¯ **å®æˆ˜å¯¼å‘** - æä¾›å®Œæ•´çš„åŠ¨æ‰‹å®è·µä»»åŠ¡

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ - ç¯å¢ƒæ­å»ºï¼ˆ5 åˆ†é’Ÿï¼‰

> åœ¨å¼€å§‹å­¦ä¹ ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆæ­å»ºå¥½å¼€å‘ç¯å¢ƒï¼Œç¡®ä¿åé¢çš„æ¯ä¸ªæ¡ˆä¾‹éƒ½èƒ½è¿è¡Œï¼

### ç¬¬ 1 æ­¥ï¼šå®‰è£… Trae ç¼–è¾‘å™¨

[Trae](https://www.trae.ai/) æ˜¯å­—èŠ‚è·³åŠ¨æ¨å‡ºçš„ AI åŸç”Ÿ IDEï¼Œå†…ç½®å¼ºå¤§çš„ AI åŠ©æ‰‹ï¼Œç‰¹åˆ«é€‚åˆå­¦ä¹  AI å¼€å‘ï¼š

| ç‰¹æ€§            | è¯´æ˜                                |
| --------------- | ----------------------------------- |
| **AI ä»£ç åŠ©æ‰‹** | å†…ç½® Claude/GPTï¼Œé‡åˆ°é—®é¢˜å¯ç›´æ¥è¯¢é—® |
| **æ™ºèƒ½è¡¥å…¨**    | AI é©±åŠ¨çš„ä»£ç è¡¥å…¨ï¼Œæé«˜å¼€å‘æ•ˆç‡     |
| **ä¸­æ–‡å‹å¥½**    | å®Œå–„çš„ä¸­æ–‡ç•Œé¢å’Œ AI ä¸­æ–‡å¯¹è¯æ”¯æŒ    |
| **å®Œå…¨å…è´¹**    | ä¸ªäººç‰ˆå…è´¹ä½¿ç”¨ï¼Œæ— éœ€ä»˜è´¹            |

**å®‰è£…æ­¥éª¤ï¼š**

1. è®¿é—® [https://www.trae.ai/](https://www.trae.ai/)
2. ä¸‹è½½å¹¶å®‰è£… Trae ç¼–è¾‘å™¨ï¼ˆæ”¯æŒ Mac/Windowsï¼‰
3. æ‰“å¼€ Traeï¼Œç™»å½•è´¦å·

### ç¬¬ 2 æ­¥ï¼šåˆ›å»ºé¡¹ç›®

æ‰“å¼€ Traeï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ä½œä¸ºå­¦ä¹ é¡¹ç›®ï¼š

```bash
# åˆ›å»ºé¡¹ç›®æ–‡ä»¶å¤¹
mkdir langchain-tools-demo
cd langchain-tools-demo

# åˆå§‹åŒ– Node.js é¡¹ç›®
npm init -y
```

### ç¬¬ 3 æ­¥ï¼šå®‰è£…ä¾èµ–

åœ¨ Trae ç»ˆç«¯ï¼ˆå¿«æ·é”® `` Ctrl + ` `` æˆ– `` Cmd + ` ``ï¼‰ä¸­æ‰§è¡Œï¼š

```bash
npm install @langchain/core @langchain/deepseek zod dotenv
```

**ä¾èµ–è¯´æ˜ï¼š**

| åŒ…å                  | ä½œç”¨                                 |
| --------------------- | ------------------------------------ |
| `@langchain/core`     | LangChain æ ¸å¿ƒåº“ï¼ŒåŒ…å« Tool ç›¸å…³ API |
| `@langchain/deepseek` | DeepSeek å¤§æ¨¡å‹é›†æˆ                  |
| `zod`                 | Schema éªŒè¯åº“ï¼Œç”¨äºå®šä¹‰å·¥å…·å‚æ•°      |
| `dotenv`              | ç¯å¢ƒå˜é‡ç®¡ç†                         |

### ç¬¬ 4 æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
# DeepSeek API Keyï¼ˆå¿…éœ€ï¼‰
# è·å–åœ°å€: https://platform.deepseek.com/
DEEPSEEK_API_KEY=sk-xxxxxxxxxxxxxxxx
```

> ğŸ’¡ **å¦‚ä½•è·å– DeepSeek API Keyï¼Ÿ**
>
> 1. è®¿é—® [https://platform.deepseek.com/](https://platform.deepseek.com/)
> 2. æ³¨å†Œå¹¶ç™»å½•è´¦å·
> 3. åœ¨ API Keys é¡µé¢åˆ›å»ºæ–°çš„ Key
> 4. æ–°ç”¨æˆ·èµ é€å…è´¹é¢åº¦ï¼Œè¶³å¤Ÿå­¦ä¹ ä½¿ç”¨

### ç¬¬ 5 æ­¥ï¼šé…ç½® package.json

ä¿®æ”¹ `package.json`ï¼Œæ·»åŠ  ES Module æ”¯æŒï¼š

```json
{
  "name": "langchain-tools-demo",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "dependencies": {
    "@langchain/core": "^1.1.0",
    "@langchain/deepseek": "^1.0.2",
    "dotenv": "^17.0.0",
    "zod": "^3.23.0"
  }
}
```

### ç¬¬ 6 æ­¥ï¼šåˆ›å»ºç¬¬ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶

åˆ›å»º `test-setup.js` éªŒè¯ç¯å¢ƒï¼š

```javascript
import { ChatDeepSeek } from "@langchain/deepseek";
import "dotenv/config";

// æµ‹è¯• LLM è¿æ¥
const llm = new ChatDeepSeek({
  model: "deepseek-chat",
  temperature: 0,
});

const response = await llm.invoke("ä½ å¥½ï¼Œè¯·ç”¨ä¸€å¥è¯ä»‹ç»è‡ªå·±");
console.log("âœ… ç¯å¢ƒé…ç½®æˆåŠŸï¼");
console.log("AI å›å¤:", response.content);
```

è¿è¡Œæµ‹è¯•ï¼š

```bash
node test-setup.js
```

å¦‚æœçœ‹åˆ° AI çš„å›å¤ï¼Œè¯´æ˜ç¯å¢ƒé…ç½®æˆåŠŸï¼ğŸ‰

### ç¯å¢ƒé—®é¢˜æ’æŸ¥

| é—®é¢˜                       | è§£å†³æ–¹æ¡ˆ                                        |
| -------------------------- | ----------------------------------------------- |
| `Cannot find module`       | è¿è¡Œ `npm install` å®‰è£…ä¾èµ–                     |
| `DEEPSEEK_API_KEY not set` | æ£€æŸ¥ `.env` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®              |
| `ERR_MODULE_NOT_FOUND`     | æ£€æŸ¥ `package.json` ä¸­æ˜¯å¦æœ‰ `"type": "module"` |
| ç½‘ç»œè¿æ¥é”™è¯¯               | æ£€æŸ¥ç½‘ç»œï¼ŒDeepSeek API éœ€è¦èƒ½è®¿é—®å¤–ç½‘           |

---

## ğŸ“š ç›®å½•

- [ä»€ä¹ˆæ˜¯ Toolsï¼Ÿ](#ä»€ä¹ˆæ˜¯-tools)
- [ä¸ºä»€ä¹ˆéœ€è¦ Toolsï¼Ÿ](#ä¸ºä»€ä¹ˆéœ€è¦-tools)
- [Tools çš„æ ¸å¿ƒæ¦‚å¿µ](#tools-çš„æ ¸å¿ƒæ¦‚å¿µ)
- [åˆ›å»ºè‡ªå®šä¹‰ Tool](#åˆ›å»ºè‡ªå®šä¹‰-tool)
- [å·¥å…·ç»‘å®šä¸è°ƒç”¨](#å·¥å…·ç»‘å®šä¸è°ƒç”¨)
- [å®Œæ•´çš„å·¥å…·è°ƒç”¨å¾ªç¯](#å®Œæ•´çš„å·¥å…·è°ƒç”¨å¾ªç¯)
- [LangChain å†…ç½®å·¥å…· - TavilySearch](#langchain-å†…ç½®å·¥å…·---tavilysearch)
- [Agent æ™ºèƒ½ä»£ç†ï¼ˆè¿›é˜¶ï¼‰](#agent-æ™ºèƒ½ä»£ç†è¿›é˜¶)
- [å®æˆ˜æ¡ˆä¾‹åˆ†æ](#å®æˆ˜æ¡ˆä¾‹åˆ†æ)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å¸¸è§é—®é¢˜ FAQ](#å¸¸è§é—®é¢˜-faq)

---

## ä»€ä¹ˆæ˜¯ Toolsï¼Ÿ

### ğŸ¤” ä¸€å¥è¯è§£é‡Š

**Tools æ˜¯è®©å¤§è¯­è¨€æ¨¡å‹èƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨åŠŸèƒ½ï¼ˆå¦‚æŸ¥è¯¢æ•°æ®ã€æ‰§è¡Œè®¡ç®—ã€è°ƒç”¨ APIï¼‰çš„æœºåˆ¶ã€‚**

### å½¢è±¡æ¯”å–»

æƒ³è±¡ä½ æ˜¯ä¸€ä¸ªéå¸¸èªæ˜çš„äººï¼ˆAIï¼‰ï¼Œä½†ä½ ï¼š

- âŒ ä¸çŸ¥é“ç°åœ¨å‡ ç‚¹ï¼ˆæ²¡æœ‰å®æ—¶ä¿¡æ¯ï¼‰
- âŒ ç®—ä¸äº†å¤æ‚æ•°å­¦ï¼ˆåªèƒ½ç²—ç•¥ä¼°ç®—ï¼‰
- âŒ æŸ¥ä¸äº†æ•°æ®åº“ï¼ˆæ²¡æœ‰è®¿é—®æƒé™ï¼‰

**Tools å°±åƒç»™ä½ é…å¤‡äº†ï¼š**

- â° ä¸€å—æ‰‹è¡¨ï¼ˆæŸ¥è¯¢æ—¶é—´å·¥å…·ï¼‰
- ğŸ§® ä¸€ä¸ªè®¡ç®—å™¨ï¼ˆæ•°å­¦è®¡ç®—å·¥å…·ï¼‰
- ğŸ’¾ ä¸€ä¸ªæ•°æ®åº“ç»ˆç«¯ï¼ˆæ•°æ®æŸ¥è¯¢å·¥å…·ï¼‰

ç°åœ¨ä½ å¯ä»¥é€šè¿‡è¿™äº›"å·¥å…·"æ¥å®ŒæˆåŸæœ¬åšä¸åˆ°çš„äº‹æƒ…ï¼

---

## ä¸ºä»€ä¹ˆéœ€è¦ Toolsï¼Ÿ

### LLM çš„å¤©ç„¶å±€é™æ€§

| å±€é™æ€§           | è¯´æ˜                                 | Tools å¦‚ä½•è§£å†³           |
| ---------------- | ------------------------------------ | ------------------------ |
| **çŸ¥è¯†æˆªæ­¢æ—¥æœŸ** | è®­ç»ƒæ•°æ®æœ‰æ—¶é—´é™åˆ¶ï¼Œæ— æ³•è·å–æœ€æ–°ä¿¡æ¯ | é€šè¿‡æœç´¢å·¥å…·è·å–å®æ—¶ä¿¡æ¯ |
| **æ— æ³•æ‰§è¡Œè®¡ç®—** | åªèƒ½ä¼°ç®—ï¼Œä¸èƒ½ç²¾ç¡®è®¡ç®—               | è°ƒç”¨è®¡ç®—å™¨å·¥å…·           |
| **æ— æ³•è®¿é—®æ•°æ®** | æ— æ³•æŸ¥è¯¢æ•°æ®åº“æˆ–è°ƒç”¨ API             | é€šè¿‡æ•°æ®æŸ¥è¯¢å·¥å…·è®¿é—®     |
| **æ— æ³•æ‰§è¡Œæ“ä½œ** | ä¸èƒ½å‘é€é‚®ä»¶ã€ä¿®æ”¹æ–‡ä»¶ç­‰             | é€šè¿‡æ“ä½œç±»å·¥å…·æ‰§è¡Œ       |

### æ²¡æœ‰ Tools vs æœ‰ Tools

#### âŒ æ²¡æœ‰ Tools

```
ç”¨æˆ·: åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ
AI: æŠ±æ­‰ï¼Œæˆ‘æ— æ³•è·å–å®æ—¶å¤©æ°”ä¿¡æ¯ã€‚å»ºè®®ä½ è®¿é—®å¤©æ°”é¢„æŠ¥ç½‘ç«™...
```

#### âœ… æœ‰ Tools

```
ç”¨æˆ·: åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ
AI: [è°ƒç”¨å¤©æ°”å·¥å…·]
    â†’ è·å–åˆ°: åŒ—äº¬ä»Šå¤©æ™´æœ—ï¼Œæ¸©åº¦ 15Â°Cï¼Œæ¹¿åº¦ 45%

å›ç­”: åŒ—äº¬ä»Šå¤©å¤©æ°”æ™´æœ—ï¼Œæ¸©åº¦ 15Â°Cï¼Œæ¹¿åº¦ 45%ï¼Œé€‚åˆå‡ºè¡Œï¼
```

---

## Tools çš„æ ¸å¿ƒæ¦‚å¿µ

### 1. Tool çš„å››è¦ç´ 

```javascript
const myTool = new DynamicStructuredTool({
  // 1ï¸âƒ£ åç§° - AI ç”¨æ¥è¯†åˆ«å·¥å…·
  name: "get_weather",

  // 2ï¸âƒ£ æè¿° - å‘Šè¯‰ AI ä»€ä¹ˆæ—¶å€™ä½¿ç”¨è¿™ä¸ªå·¥å…·
  description: "è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯ã€‚å½“ç”¨æˆ·è¯¢é—®å¤©æ°”æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚",

  // 3ï¸âƒ£ å‚æ•° Schema - å®šä¹‰å·¥å…·éœ€è¦ä»€ä¹ˆè¾“å…¥
  schema: z.object({
    city: z.string().describe("åŸå¸‚åç§°"),
    unit: z.enum(["celsius", "fahrenheit"]).optional(),
  }),

  // 4ï¸âƒ£ æ‰§è¡Œå‡½æ•° - å·¥å…·çš„å®é™…é€»è¾‘
  func: async ({ city, unit }) => {
    // è°ƒç”¨å¤©æ°” API
    const weather = await fetchWeather(city);
    return JSON.stringify(weather);
  },
});
```

### 2. Tool çš„å·¥ä½œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æé—®    â”‚ "åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI åˆ†æ     â”‚ éœ€è¦è°ƒç”¨ get_weather å·¥å…·
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Tool è°ƒç”¨   â”‚ get_weather({ city: "åŒ—äº¬" })
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è¿”å›ç»“æœ    â”‚ { temp: 15, condition: "æ™´" }
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI æ•´åˆç­”æ¡ˆ â”‚ "åŒ—äº¬ä»Šå¤©æ™´æœ—ï¼Œ15Â°C"
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. Tool çš„ç±»å‹

| ç±»å‹           | ç±»å                    | é€‚ç”¨åœºæ™¯                       |
| -------------- | ----------------------- | ------------------------------ |
| **ç»“æ„åŒ–å·¥å…·** | `DynamicStructuredTool` | éœ€è¦æ˜ç¡®å‚æ•°å®šä¹‰çš„å·¥å…·ï¼ˆæ¨èï¼‰ |
| **ç®€å•å·¥å…·**   | `Tool`                  | å‚æ•°ç®€å•çš„å·¥å…·ï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰     |
| **å†…ç½®å·¥å…·**   | å¦‚ `Calculator`         | ä½¿ç”¨ LangChain æä¾›çš„ç°æˆå·¥å…·  |

---

## åˆ›å»ºè‡ªå®šä¹‰ Tool

### ç¤ºä¾‹ 1: å¤©æ°”æŸ¥è¯¢å·¥å…·

```javascript
import { DynamicStructuredTool } from "@langchain/core/tools";
import { z } from "zod";

const weatherTool = new DynamicStructuredTool({
  name: "get_weather",
  description: "è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯ã€‚å½“ç”¨æˆ·è¯¢é—®å¤©æ°”æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚",

  schema: z.object({
    city: z.string().describe("åŸå¸‚åç§°ï¼Œä¾‹å¦‚ï¼šåŒ—äº¬ã€ä¸Šæµ·ã€æ·±åœ³"),
    unit: z.enum(["celsius", "fahrenheit"]).optional().describe("æ¸©åº¦å•ä½"),
  }),

  func: async ({ city, unit = "celsius" }) => {
    // å®é™…åº”ç”¨ä¸­è¿™é‡Œä¼šè°ƒç”¨çœŸå®çš„å¤©æ°” API
    const weatherData = {
      åŒ—äº¬: { temp: 15, condition: "æ™´æœ—", humidity: 45 },
      ä¸Šæµ·: { temp: 20, condition: "å¤šäº‘", humidity: 65 },
    };

    const data = weatherData[city] || {
      temp: 22,
      condition: "æœªçŸ¥",
      humidity: 50,
    };

    return JSON.stringify({
      city: city,
      temperature: `${data.temp}Â°C`,
      condition: data.condition,
      humidity: `${data.humidity}%`,
    });
  },
});
```

### ç¤ºä¾‹ 2: è®¡ç®—å™¨å·¥å…·

```javascript
const calculatorTool = new DynamicStructuredTool({
  name: "calculator",
  description: "æ‰§è¡Œæ•°å­¦è®¡ç®—ã€‚æ”¯æŒåŠ å‡ä¹˜é™¤ã€å¹‚è¿ç®—ç­‰ã€‚",

  schema: z.object({
    expression: z.string().describe("æ•°å­¦è¡¨è¾¾å¼ï¼Œä¾‹å¦‚: '2 + 3 * 4'"),
  }),

  func: async ({ expression }) => {
    try {
      // ç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨ math.js ç­‰å®‰å…¨çš„åº“
      const result = Function(`"use strict"; return (${expression})`)();
      return `è®¡ç®—ç»“æœ: ${expression} = ${result}`;
    } catch (error) {
      return `è®¡ç®—é”™è¯¯: ${error.message}`;
    }
  },
});
```

### ç¤ºä¾‹ 3: æ•°æ®åº“æŸ¥è¯¢å·¥å…·

```javascript
const databaseTool = new DynamicStructuredTool({
  name: "query_database",
  description: "æŸ¥è¯¢ç”¨æˆ·æ•°æ®åº“ã€‚å¯ä»¥æ ¹æ®ç”¨æˆ· ID æˆ–é‚®ç®±æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚",

  schema: z.object({
    query_type: z.enum(["by_id", "by_email"]).describe("æŸ¥è¯¢ç±»å‹"),
    value: z.string().describe("æŸ¥è¯¢å€¼ï¼šID æˆ–é‚®ç®±"),
  }),

  func: async ({ query_type, value }) => {
    // æ¨¡æ‹Ÿæ•°æ®åº“æŸ¥è¯¢
    const users = [
      { id: "001", email: "zhang@example.com", name: "å¼ ä¸‰" },
      { id: "002", email: "li@example.com", name: "æå››" },
    ];

    let user;
    if (query_type === "by_id") {
      user = users.find((u) => u.id === value);
    } else {
      user = users.find((u) => u.email === value);
    }

    return user ? JSON.stringify(user) : "æœªæ‰¾åˆ°ç”¨æˆ·";
  },
});
```

### ğŸ“ å®æˆ˜ç»ƒä¹  1ï¼šåˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªå·¥å…·

åœ¨é¡¹ç›®ä¸­åˆ›å»º `01-create-tool.js` æ–‡ä»¶ï¼Œå®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

```javascript
/**
 * å®æˆ˜ç»ƒä¹  1ï¼šåˆ›å»ºè‡ªå®šä¹‰å·¥å…·
 * è¿è¡Œå‘½ä»¤ï¼šnode 01-create-tool.js
 */
import { DynamicStructuredTool } from "@langchain/core/tools";
import { z } from "zod";
import "dotenv/config";

// åˆ›å»ºå¤©æ°”æŸ¥è¯¢å·¥å…·
const weatherTool = new DynamicStructuredTool({
  name: "get_weather",
  description: "è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯",
  schema: z.object({
    city: z.string().describe("åŸå¸‚åç§°"),
  }),
  func: async ({ city }) => {
    // æ¨¡æ‹Ÿå¤©æ°”æ•°æ®
    const weatherData = {
      åŒ—äº¬: { temp: 15, condition: "æ™´æœ—" },
      ä¸Šæµ·: { temp: 20, condition: "å¤šäº‘" },
      æ·±åœ³: { temp: 28, condition: "å°é›¨" },
    };
    const data = weatherData[city] || { temp: 25, condition: "æœªçŸ¥" };
    return JSON.stringify({ city, ...data });
  },
});

// åˆ›å»ºè®¡ç®—å™¨å·¥å…·
const calculatorTool = new DynamicStructuredTool({
  name: "calculator",
  description: "æ‰§è¡Œæ•°å­¦è®¡ç®—",
  schema: z.object({
    expression: z.string().describe("æ•°å­¦è¡¨è¾¾å¼"),
  }),
  func: async ({ expression }) => {
    try {
      const result = Function(`"use strict"; return (${expression})`)();
      return `${expression} = ${result}`;
    } catch (e) {
      return `è®¡ç®—é”™è¯¯: ${e.message}`;
    }
  },
});

// æµ‹è¯•å·¥å…·
console.log("ğŸ”§ æµ‹è¯•å¤©æ°”å·¥å…·:");
const weather = await weatherTool.invoke({ city: "åŒ—äº¬" });
console.log(weather);

console.log("\nğŸ”§ æµ‹è¯•è®¡ç®—å™¨å·¥å…·:");
const calc = await calculatorTool.invoke({ expression: "2 + 3 * 4" });
console.log(calc);

console.log("\nâœ… å·¥å…·åˆ›å»ºæˆåŠŸï¼");
```

**è¿è¡Œæµ‹è¯•ï¼š**

```bash
node 01-create-tool.js
```

**é¢„æœŸè¾“å‡ºï¼š**

```
ğŸ”§ æµ‹è¯•å¤©æ°”å·¥å…·:
{"city":"åŒ—äº¬","temp":15,"condition":"æ™´æœ—"}

ğŸ”§ æµ‹è¯•è®¡ç®—å™¨å·¥å…·:
2 + 3 * 4 = 14

âœ… å·¥å…·åˆ›å»ºæˆåŠŸï¼
```

---

## å·¥å…·ç»‘å®šä¸è°ƒç”¨

### 1. ç»‘å®šå·¥å…·åˆ° LLM

```javascript
import { ChatDeepSeek } from "@langchain/deepseek";

// åˆå§‹åŒ– LLM
const llm = new ChatDeepSeek({
  model: "deepseek-chat",
  temperature: 0, // å·¥å…·è°ƒç”¨å»ºè®®ä½¿ç”¨ä½æ¸©åº¦
});

// å®šä¹‰å·¥å…·åˆ—è¡¨
const tools = [weatherTool, calculatorTool, databaseTool];

// ç»‘å®šå·¥å…·
const llmWithTools = llm.bindTools(tools);
```

### 2. è°ƒç”¨å¹¶æ£€æŸ¥å·¥å…·è¯·æ±‚

```javascript
// ç”¨æˆ·æé—®
const response = await llmWithTools.invoke("åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ");

// æ£€æŸ¥ AI æ˜¯å¦è¯·æ±‚è°ƒç”¨å·¥å…·
if (response.tool_calls && response.tool_calls.length > 0) {
  console.log("AI å†³å®šè°ƒç”¨å·¥å…·:");

  for (const toolCall of response.tool_calls) {
    console.log(`å·¥å…·åç§°: ${toolCall.name}`);
    console.log(`å‚æ•°:`, toolCall.args);

    // æ‰¾åˆ°å¯¹åº”çš„å·¥å…·å¹¶æ‰§è¡Œ
    const tool = tools.find((t) => t.name === toolCall.name);
    if (tool) {
      const result = await tool.invoke(toolCall.args);
      console.log(`å·¥å…·è¿”å›:`, result);
    }
  }
} else {
  // AI ç›´æ¥å›ç­”ï¼Œæ— éœ€å·¥å…·
  console.log("AI å›ç­”:", response.content);
}
```

### 3. å·¥å…·è°ƒç”¨çš„å®Œæ•´æµç¨‹

```javascript
// å®Œæ•´ç¤ºä¾‹ï¼šAI è‡ªåŠ¨é€‰æ‹©å¹¶è°ƒç”¨å·¥å…·
async function askWithTools(question) {
  console.log(`ğŸ¤” ç”¨æˆ·: ${question}\n`);

  // 1. AI åˆ†æé—®é¢˜å¹¶å†³å®šæ˜¯å¦éœ€è¦å·¥å…·
  const response = await llmWithTools.invoke(question);

  // 2. å¦‚æœéœ€è¦å·¥å…·ï¼Œæ‰§è¡Œå·¥å…·è°ƒç”¨
  if (response.tool_calls && response.tool_calls.length > 0) {
    const toolResults = [];

    for (const toolCall of response.tool_calls) {
      const tool = tools.find((t) => t.name === toolCall.name);
      if (tool) {
        const result = await tool.invoke(toolCall.args);
        toolResults.push({
          name: toolCall.name,
          result: result,
        });
      }
    }

    // 3. å°†å·¥å…·ç»“æœè¿”å›ç»™ AIï¼Œè®© AI ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ
    console.log("âœ… å·¥å…·è°ƒç”¨å®Œæˆï¼Œç»“æœ:", toolResults);

    // å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦å°†å·¥å…·ç»“æœä¼ å› AI ç»§ç»­å¯¹è¯
    // è¿™é€šå¸¸é€šè¿‡ Agent è‡ªåŠ¨å®Œæˆï¼ˆè§ä¸‹ä¸€èŠ‚ï¼‰
  } else {
    console.log("âœ… AI ç›´æ¥å›ç­”:", response.content);
  }
}

// æµ‹è¯•
await askWithTools("åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ");
await askWithTools("è®¡ç®— 123 * 456");
await askWithTools("ä½ å¥½");
```

### ğŸ“ å®æˆ˜ç»ƒä¹  2ï¼šAI è‡ªåŠ¨é€‰æ‹©å·¥å…·

åˆ›å»º `02-bind-tools.js` æ–‡ä»¶ï¼š

```javascript
/**
 * å®æˆ˜ç»ƒä¹  2ï¼šå°†å·¥å…·ç»‘å®šåˆ° LLM
 * è¿è¡Œå‘½ä»¤ï¼šnode 02-bind-tools.js
 */
import { ChatDeepSeek } from "@langchain/deepseek";
import { DynamicStructuredTool } from "@langchain/core/tools";
import { z } from "zod";
import "dotenv/config";

// 1. åˆ›å»ºå·¥å…·
const weatherTool = new DynamicStructuredTool({
  name: "get_weather",
  description: "è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯ã€‚å½“ç”¨æˆ·è¯¢é—®å¤©æ°”æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚",
  schema: z.object({
    city: z.string().describe("åŸå¸‚åç§°"),
  }),
  func: async ({ city }) => {
    const data = { åŒ—äº¬: 15, ä¸Šæµ·: 20, æ·±åœ³: 28 };
    return JSON.stringify({ city, temp: data[city] || 25, unit: "Â°C" });
  },
});

const calculatorTool = new DynamicStructuredTool({
  name: "calculator",
  description: "æ‰§è¡Œæ•°å­¦è®¡ç®—ã€‚å½“ç”¨æˆ·éœ€è¦è®¡ç®—æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚",
  schema: z.object({
    expression: z.string().describe("æ•°å­¦è¡¨è¾¾å¼"),
  }),
  func: async ({ expression }) => {
    const result = Function(`"use strict"; return (${expression})`)();
    return `${expression} = ${result}`;
  },
});

// 2. åˆå§‹åŒ– LLM å¹¶ç»‘å®šå·¥å…·
const llm = new ChatDeepSeek({ model: "deepseek-chat", temperature: 0 });
const tools = [weatherTool, calculatorTool];
const llmWithTools = llm.bindTools(tools);

// 3. æµ‹è¯• AI è‡ªåŠ¨é€‰æ‹©å·¥å…·
async function testToolSelection(question) {
  console.log(`\nğŸ¤” ç”¨æˆ·: ${question}`);
  const response = await llmWithTools.invoke(question);

  if (response.tool_calls && response.tool_calls.length > 0) {
    console.log("ğŸ”§ AI å†³å®šè°ƒç”¨å·¥å…·:");
    for (const tc of response.tool_calls) {
      console.log(`   å·¥å…·: ${tc.name}, å‚æ•°:`, tc.args);
      const tool = tools.find((t) => t.name === tc.name);
      if (tool) {
        const result = await tool.invoke(tc.args);
        console.log(`   ç»“æœ: ${result}`);
      }
    }
  } else {
    console.log("ğŸ’¬ AI ç›´æ¥å›ç­”:", response.content);
  }
}

// è¿è¡Œæµ‹è¯•
await testToolSelection("åŒ—äº¬ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ");
await testToolSelection("è®¡ç®— 15 * 8 + 20");
await testToolSelection("ä½ å¥½ï¼Œä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±");

console.log("\nâœ… æµ‹è¯•å®Œæˆï¼");
```

**è¿è¡Œæµ‹è¯•ï¼š**

```bash
node 02-bind-tools.js
```

**è§‚å¯Ÿè¦ç‚¹ï¼š**

- AI ä¼šæ ¹æ®é—®é¢˜è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å·¥å…·
- è¯¢é—®å¤©æ°”æ—¶ï¼ŒAI è°ƒç”¨ `get_weather` å·¥å…·
- éœ€è¦è®¡ç®—æ—¶ï¼ŒAI è°ƒç”¨ `calculator` å·¥å…·
- æ™®é€šå¯¹è¯æ—¶ï¼ŒAI ç›´æ¥å›ç­”ï¼Œä¸è°ƒç”¨å·¥å…·

---

## å®Œæ•´çš„å·¥å…·è°ƒç”¨å¾ªç¯

### æ ¸å¿ƒæ¦‚å¿µï¼šToolMessage

åœ¨ LangChain ä¸­ï¼Œå®Œæ•´çš„å·¥å…·è°ƒç”¨æµç¨‹éœ€è¦ä½¿ç”¨ `ToolMessage` æ¥å°†å·¥å…·æ‰§è¡Œç»“æœä¼ å›ç»™ AIï¼š

```javascript
import { HumanMessage, AIMessage, ToolMessage } from "@langchain/core/messages";
```

### å·¥å…·è°ƒç”¨çš„å®Œæ•´æµç¨‹

```
ç”¨æˆ·: "ä¸Šæµ·ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 1 æ­¥ï¼šå‘é€ç”¨æˆ·æ¶ˆæ¯ç»™ AI              â”‚
â”‚ â†’ messages = [HumanMessage("...")]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 2 æ­¥ï¼šAI åˆ†æå¹¶è¿”å› tool_calls       â”‚
â”‚ â†’ aiResponse.tool_calls = [...]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 3 æ­¥ï¼šæ‰§è¡Œå·¥å…·è°ƒç”¨                   â”‚
â”‚ â†’ result = await tool.invoke(args)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 4 æ­¥ï¼šå°†å·¥å…·ç»“æœåŒ…è£…ä¸º ToolMessage   â”‚
â”‚ â†’ messages.push(ToolMessage(...))      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¬¬ 5 æ­¥ï¼šå°†æ‰€æœ‰æ¶ˆæ¯å‘é€ç»™ AI            â”‚
â”‚ â†’ AI æ ¹æ®å·¥å…·ç»“æœç”Ÿæˆæœ€ç»ˆå›ç­”           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
æœ€ç»ˆå›ç­”: "ä¸Šæµ·ä»Šå¤©å¤©æ°”å¤šäº‘ï¼Œæ¸©åº¦ 20Â°Cï¼Œæ¹¿åº¦ 65%ã€‚"
```

### å®ç°å®Œæ•´çš„å·¥å…·è°ƒç”¨å¾ªç¯

```javascript
import { HumanMessage, ToolMessage } from "@langchain/core/messages";

/**
 * å®Œæ•´çš„å·¥å…·è°ƒç”¨æµç¨‹ï¼š
 * 1. ç”¨æˆ·æé—®
 * 2. AI åˆ†æå¹¶è¿”å› tool_calls
 * 3. æ‰§è¡Œå·¥å…·è°ƒç”¨
 * 4. å°†å·¥å…·ç»“æœä½œä¸º ToolMessage ä¼ å› AI
 * 5. AI æ ¹æ®å·¥å…·ç»“æœç”Ÿæˆæœ€ç»ˆå›ç­”
 */
async function chatWithTools(question) {
  console.log(`ğŸ¤” ç”¨æˆ·: ${question}\n`);

  // ç¬¬ 1 æ­¥ï¼šå°†ç”¨æˆ·é—®é¢˜å‘é€ç»™ AI
  const messages = [new HumanMessage(question)];
  const aiResponse = await llmWithTools.invoke(messages);

  // ç¬¬ 2 æ­¥ï¼šæ£€æŸ¥ AI æ˜¯å¦éœ€è¦è°ƒç”¨å·¥å…·
  if (aiResponse.tool_calls && aiResponse.tool_calls.length > 0) {
    console.log("ğŸ”§ AI å†³å®šè°ƒç”¨ä»¥ä¸‹å·¥å…·:");

    // ä¿å­˜ AI çš„å“åº”ï¼ˆåŒ…å« tool_callsï¼‰
    messages.push(aiResponse);

    // ç¬¬ 3 æ­¥ï¼šæ‰§è¡Œæ¯ä¸ªå·¥å…·è°ƒç”¨
    for (const toolCall of aiResponse.tool_calls) {
      console.log(`  - å·¥å…·: ${toolCall.name}`);
      console.log(`    å‚æ•°:`, toolCall.args);

      const tool = tools.find((t) => t.name === toolCall.name);
      if (tool) {
        const result = await tool.invoke(toolCall.args);
        console.log(`    ç»“æœ:`, result);

        // ç¬¬ 4 æ­¥ï¼šå°†å·¥å…·ç»“æœä½œä¸º ToolMessage æ·»åŠ åˆ°æ¶ˆæ¯åˆ—è¡¨
        messages.push(
          new ToolMessage({
            tool_call_id: toolCall.id,
            content: result,
          })
        );
      }
    }

    // ç¬¬ 5 æ­¥ï¼šå°†æ‰€æœ‰æ¶ˆæ¯ï¼ˆåŒ…æ‹¬å·¥å…·ç»“æœï¼‰å‘é€ç»™ AIï¼Œè·å–æœ€ç»ˆå›ç­”
    console.log("\nğŸ“ AI æ•´åˆå·¥å…·ç»“æœ...\n");
    const finalResponse = await llmWithTools.invoke(messages);
    console.log("âœ… AI æœ€ç»ˆå›ç­”:", finalResponse.content);

    return finalResponse.content;
  } else {
    // AI ç›´æ¥å›ç­”ï¼Œæ— éœ€å·¥å…·
    console.log("âœ… AI ç›´æ¥å›ç­”:", aiResponse.content);
    return aiResponse.content;
  }
}

// ä½¿ç”¨ç¤ºä¾‹
await chatWithTools("ä¸Šæµ·ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ");
await chatWithTools("ç°åœ¨å‡ ç‚¹äº†ï¼Ÿ");
await chatWithTools("ä½ å¥½ï¼Œä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±"); // æ— éœ€å·¥å…·
```

### ToolMessage çš„å…³é”®å±æ€§

| å±æ€§           | è¯´æ˜                                |
| -------------- | ----------------------------------- |
| `tool_call_id` | å¿…é¡»ä¸ AI è¿”å›çš„ `toolCall.id` å¯¹åº” |
| `content`      | å·¥å…·çš„æ‰§è¡Œç»“æœï¼ˆå­—ç¬¦ä¸²ï¼‰            |

### ä¸ºä»€ä¹ˆéœ€è¦ ToolMessageï¼Ÿ

1. **å¯¹è¯å®Œæ•´æ€§**ï¼šè®© AI çŸ¥é“å·¥å…·å·²æ‰§è¡Œå¹¶è·å–ç»“æœ
2. **ä¸Šä¸‹æ–‡è¿ç»­**ï¼šAI å¯ä»¥åŸºäºå·¥å…·ç»“æœç»§ç»­æ¨ç†
3. **å¤šå·¥å…·æ”¯æŒ**ï¼šé€šè¿‡ `tool_call_id` åŒ¹é…å¤šä¸ªå¹¶è¡Œè°ƒç”¨

### ğŸ“ å®æˆ˜ç»ƒä¹  3ï¼šå®Œæ•´çš„å·¥å…·è°ƒç”¨å¾ªç¯

åˆ›å»º `03-tool-loop.js` æ–‡ä»¶ï¼š

```javascript
/**
 * å®æˆ˜ç»ƒä¹  3ï¼šå®Œæ•´çš„å·¥å…·è°ƒç”¨å¾ªç¯
 * è¿è¡Œå‘½ä»¤ï¼šnode 03-tool-loop.js
 */
import { ChatDeepSeek } from "@langchain/deepseek";
import { DynamicStructuredTool } from "@langchain/core/tools";
import { HumanMessage, ToolMessage } from "@langchain/core/messages";
import { z } from "zod";
import "dotenv/config";

// åˆ›å»ºå·¥å…·
const weatherTool = new DynamicStructuredTool({
  name: "get_weather",
  description: "è·å–åŸå¸‚å¤©æ°”",
  schema: z.object({ city: z.string() }),
  func: async ({ city }) => {
    const data = { åŒ—äº¬: "æ™´æœ— 15Â°C", ä¸Šæµ·: "å¤šäº‘ 20Â°C", æ·±åœ³: "å°é›¨ 28Â°C" };
    return data[city] || "æœªçŸ¥åŸå¸‚";
  },
});

const timeTool = new DynamicStructuredTool({
  name: "get_time",
  description: "è·å–å½“å‰æ—¶é—´",
  schema: z.object({}),
  func: async () => new Date().toLocaleString("zh-CN"),
});

// åˆå§‹åŒ–
const llm = new ChatDeepSeek({ model: "deepseek-chat", temperature: 0 });
const tools = [weatherTool, timeTool];
const llmWithTools = llm.bindTools(tools);

// å®Œæ•´çš„å·¥å…·è°ƒç”¨å¾ªç¯
async function chat(question) {
  console.log(`\nğŸ¤” ç”¨æˆ·: ${question}\n`);

  // ç¬¬ 1 æ­¥ï¼šå‘é€é—®é¢˜
  const messages = [new HumanMessage(question)];
  const response = await llmWithTools.invoke(messages);

  // ç¬¬ 2 æ­¥ï¼šæ£€æŸ¥æ˜¯å¦éœ€è¦å·¥å…·
  if (response.tool_calls && response.tool_calls.length > 0) {
    console.log("ğŸ”§ è°ƒç”¨å·¥å…·ä¸­...");
    messages.push(response);

    // ç¬¬ 3 æ­¥ï¼šæ‰§è¡Œå·¥å…·
    for (const tc of response.tool_calls) {
      const tool = tools.find((t) => t.name === tc.name);
      if (tool) {
        const result = await tool.invoke(tc.args);
        console.log(`   ${tc.name}: ${result}`);

        // ç¬¬ 4 æ­¥ï¼šæ·»åŠ  ToolMessage
        messages.push(
          new ToolMessage({
            tool_call_id: tc.id,
            content: result,
          })
        );
      }
    }

    // ç¬¬ 5 æ­¥ï¼šè·å–æœ€ç»ˆå›ç­”
    const final = await llmWithTools.invoke(messages);
    console.log("\nâœ… AI:", final.content);
    return final.content;
  }

  console.log("âœ… AI:", response.content);
  return response.content;
}

// æµ‹è¯•
await chat("åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ");
await chat("ç°åœ¨å‡ ç‚¹äº†ï¼Ÿ");
await chat("ä½ å¥½");
```

**è¿è¡Œæµ‹è¯•ï¼š**

```bash
node 03-tool-loop.js
```

**å…³é”®å­¦ä¹ ç‚¹ï¼š**

- `HumanMessage`ï¼šç”¨æˆ·æ¶ˆæ¯
- `ToolMessage`ï¼šå·¥å…·ç»“æœæ¶ˆæ¯ï¼Œå¿…é¡»åŒ…å« `tool_call_id`
- AI ä¼šæ•´åˆå·¥å…·ç»“æœï¼Œç”Ÿæˆè‡ªç„¶è¯­è¨€å›ç­”

---

## LangChain å†…ç½®å·¥å…· - TavilySearch

> ğŸ” è®© AI æ‹¥æœ‰çœŸæ­£çš„äº’è”ç½‘æœç´¢èƒ½åŠ›

### ä»€ä¹ˆæ˜¯ TavilySearchï¼Ÿ

**TavilySearch** æ˜¯ LangChain å®˜æ–¹æ¨èçš„æœç´¢å·¥å…·ï¼Œä¸“ä¸º AI Agent è®¾è®¡ã€‚å®ƒæ˜¯ç›®å‰æœ€é€‚åˆä¸ LLM é…åˆä½¿ç”¨çš„æœç´¢å¼•æ“ã€‚

| ç‰¹æ€§             | è¯´æ˜                                          |
| ---------------- | --------------------------------------------- |
| **ä¸“ä¸º AI è®¾è®¡** | è¿”å›ç»“æ„åŒ–æ•°æ®ï¼Œä¾¿äº LLM ç†è§£å’Œå¤„ç†           |
| **å®æ—¶æœç´¢**     | è·å–äº’è”ç½‘æœ€æ–°ä¿¡æ¯ï¼Œçªç ´ LLM çŸ¥è¯†æˆªæ­¢æ—¥æœŸé™åˆ¶ |
| **å…è´¹é¢åº¦**     | æ¯æœˆ 1000 æ¬¡å…è´¹è°ƒç”¨ï¼Œè¶³å¤Ÿå­¦ä¹ å’Œä¸ªäººé¡¹ç›®ä½¿ç”¨  |
| **æ˜“äºé›†æˆ**     | LangChain åŸç”Ÿæ”¯æŒï¼Œå‡ è¡Œä»£ç å³å¯ä½¿ç”¨          |

### è·å– Tavily API Key

1. è®¿é—® [https://tavily.com/](https://tavily.com/)
2. ç‚¹å‡» "Get API Key" æ³¨å†Œè´¦å·ï¼ˆæ”¯æŒ GitHub/Google ä¸€é”®ç™»å½•ï¼‰
3. åœ¨ Dashboard ä¸­å¤åˆ¶ä½ çš„ API Key
4. åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```bash
TAVILY_API_KEY=tvly-xxxxxxxxxxxxxxxxx
```

### å®‰è£…ä¾èµ–

```bash
npm install @langchain/tavily
```

### åŸºç¡€ä½¿ç”¨

```javascript
import { TavilySearch } from "@langchain/tavily";
import "dotenv/config";

// åˆ›å»º TavilySearch å·¥å…·å®ä¾‹
const tavilyTool = new TavilySearch({
  maxResults: 3, // è¿”å›ç»“æœæ•°é‡ï¼ˆ1-10ï¼‰
  // topic: "general",  // å¯é€‰: "general" | "news"
  // includeAnswer: true, // å¯é€‰: æ˜¯å¦åŒ…å« AI ç”Ÿæˆçš„æ‘˜è¦
});

// ç›´æ¥è°ƒç”¨æœç´¢ï¼ˆæ³¨æ„ï¼šéœ€è¦ä¼ å…¥å¯¹è±¡æ ¼å¼ï¼‰
const result = await tavilyTool.invoke({ query: "LangChain æœ€æ–°ç‰ˆæœ¬ç‰¹æ€§" });
console.log(JSON.stringify(result, null, 2));
```

### ä¸ LLM é›†æˆä½¿ç”¨

```javascript
import { ChatDeepSeek } from "@langchain/deepseek";
import { TavilySearch } from "@langchain/tavily";
import { HumanMessage, ToolMessage } from "@langchain/core/messages";

// åˆå§‹åŒ– LLM å’Œæœç´¢å·¥å…·
const llm = new ChatDeepSeek({ model: "deepseek-chat", temperature: 0 });
const tavilyTool = new TavilySearch({ maxResults: 3 });

// ç»‘å®šå·¥å…·åˆ° LLM
const llmWithSearch = llm.bindTools([tavilyTool]);

// å®Œæ•´çš„æœç´¢é—®ç­”æµç¨‹
async function searchAndAnswer(question) {
  const messages = [new HumanMessage(question)];
  const response = await llmWithSearch.invoke(messages);

  if (response.tool_calls && response.tool_calls.length > 0) {
    messages.push(response);

    for (const toolCall of response.tool_calls) {
      const result = await tavilyTool.invoke(toolCall.args);
      // TavilySearch è¿”å›å¯¹è±¡ï¼Œéœ€è¦è½¬æ¢ä¸ºå­—ç¬¦ä¸²
      const resultStr =
        typeof result === "string" ? result : JSON.stringify(result);
      messages.push(
        new ToolMessage({
          tool_call_id: toolCall.id,
          content: resultStr, // ToolMessage çš„ content å¿…é¡»æ˜¯å­—ç¬¦ä¸²
        })
      );
    }

    // AI æ•´åˆæœç´¢ç»“æœç”Ÿæˆæœ€ç»ˆç­”æ¡ˆ
    const finalResponse = await llmWithSearch.invoke(messages);
    return finalResponse.content;
  }

  return response.content;
}

// ä½¿ç”¨ç¤ºä¾‹
const answer = await searchAndAnswer("2024å¹´ AI é¢†åŸŸæœ‰å“ªäº›é‡å¤§çªç ´ï¼Ÿ");
console.log(answer);
```

### TavilySearch é…ç½®é€‰é¡¹

| å‚æ•°                | ç±»å‹    | é»˜è®¤å€¼    | è¯´æ˜                            |
| ------------------- | ------- | --------- | ------------------------------- |
| `maxResults`        | number  | 5         | è¿”å›ç»“æœæ•°é‡ï¼ˆ1-10ï¼‰            |
| `topic`             | string  | "general" | æœç´¢ä¸»é¢˜ï¼š"general" æˆ– "news"   |
| `includeAnswer`     | boolean | false     | æ˜¯å¦åŒ…å« AI ç”Ÿæˆçš„æ‘˜è¦ç­”æ¡ˆ      |
| `includeRawContent` | boolean | false     | æ˜¯å¦åŒ…å«åŸå§‹ç½‘é¡µå†…å®¹            |
| `searchDepth`       | string  | "basic"   | æœç´¢æ·±åº¦ï¼š"basic" æˆ– "advanced" |

### ä¸ºä»€ä¹ˆé€‰æ‹© TavilySearchï¼Ÿ

| å¯¹æ¯”é¡¹       | TavilySearch          | Google Search API | Bing Search API |
| ------------ | --------------------- | ----------------- | --------------- |
| **AI ä¼˜åŒ–**  | âœ… ä¸“ä¸º LLM è®¾è®¡      | âŒ é€šç”¨æœç´¢       | âŒ é€šç”¨æœç´¢     |
| **å…è´¹é¢åº¦** | âœ… 1000 æ¬¡/æœˆ         | âŒ éœ€ä»˜è´¹         | âš ï¸ æœ‰é™å…è´¹     |
| **æ¥å…¥éš¾åº¦** | âœ… LangChain åŸç”Ÿæ”¯æŒ | âš ï¸ éœ€è¦é¢å¤–é…ç½®   | âš ï¸ éœ€è¦é¢å¤–é…ç½® |
| **è¿”å›æ ¼å¼** | âœ… ç»“æ„åŒ–ï¼ŒLLM å‹å¥½   | âš ï¸ éœ€è¦è§£æ       | âš ï¸ éœ€è¦è§£æ     |

### ğŸ“ å®æˆ˜ç»ƒä¹  4ï¼šä½¿ç”¨ TavilySearch æœç´¢å®æ—¶ä¿¡æ¯

> âš ï¸ æœ¬ç»ƒä¹ éœ€è¦ Tavily API Keyï¼Œè¯·å…ˆå®Œæˆæ³¨å†Œ

**ç¬¬ 1 æ­¥ï¼šå®‰è£…ä¾èµ–**

```bash
npm install @langchain/tavily
```

**ç¬¬ 2 æ­¥ï¼šé…ç½® API Key**

åœ¨ `.env` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```bash
TAVILY_API_KEY=tvly-xxxxxxxxxxxxxxxx
```

**ç¬¬ 3 æ­¥ï¼šåˆ›å»º `04-tavily-search.js` æ–‡ä»¶**

```javascript
/**
 * å®æˆ˜ç»ƒä¹  4ï¼šTavilySearch çœŸå®æœç´¢
 * è¿è¡Œå‘½ä»¤ï¼šnode 04-tavily-search.js
 */
import { ChatDeepSeek } from "@langchain/deepseek";
import { TavilySearch } from "@langchain/tavily";
import { HumanMessage, ToolMessage } from "@langchain/core/messages";
import "dotenv/config";

// æ£€æŸ¥ API Key
if (!process.env.TAVILY_API_KEY) {
  console.log("âŒ è¯·å…ˆé…ç½® TAVILY_API_KEY");
  console.log("   è·å–åœ°å€: https://tavily.com/");
  process.exit(1);
}

// åˆ›å»ºæœç´¢å·¥å…·
const searchTool = new TavilySearch({ maxResults: 3 });

// åˆå§‹åŒ– LLM
const llm = new ChatDeepSeek({ model: "deepseek-chat", temperature: 0 });
const llmWithSearch = llm.bindTools([searchTool]);

// æœç´¢å¹¶å›ç­”
async function searchAndAnswer(question) {
  console.log(`\nğŸ” é—®é¢˜: ${question}\n`);

  const messages = [new HumanMessage(question)];
  const response = await llmWithSearch.invoke(messages);

  if (response.tool_calls && response.tool_calls.length > 0) {
    console.log("ğŸ“¡ æœç´¢ä¸­...");
    messages.push(response);

    for (const tc of response.tool_calls) {
      const result = await searchTool.invoke(tc.args);
      const resultStr =
        typeof result === "string" ? result : JSON.stringify(result);
      console.log(
        `   æ‰¾åˆ° ${JSON.parse(resultStr).results?.length || 0} æ¡ç»“æœ`
      );

      messages.push(
        new ToolMessage({ tool_call_id: tc.id, content: resultStr })
      );
    }

    const final = await llmWithSearch.invoke(messages);
    console.log("\nâœ… AI å›ç­”:", final.content);
    return final.content;
  }

  console.log("âœ… AI å›ç­”:", response.content);
  return response.content;
}

// æµ‹è¯•çœŸå®æœç´¢
await searchAndAnswer("2024å¹´è¯ºè´å°”ç‰©ç†å­¦å¥–å¾—ä¸»æ˜¯è°ï¼Ÿ");
```

**è¿è¡Œæµ‹è¯•ï¼š**

```bash
node 04-tavily-search.js
```

**å¦‚æœæ²¡æœ‰ Tavily API Key**ï¼Œå¯ä»¥è·³è¿‡æ­¤ç»ƒä¹ ï¼Œå‰é¢çš„ç»ƒä¹ å·²ç»æ¶µç›–äº† Tools çš„æ ¸å¿ƒæ¦‚å¿µã€‚

---

## Agent æ™ºèƒ½ä»£ç†ï¼ˆè¿›é˜¶ï¼‰

> âš ï¸ **æ³¨æ„**ï¼šåœ¨ LangChain.js v1.x ä¸­ï¼ŒAgent ç›¸å…³åŠŸèƒ½å·²è¿ç§»åˆ° `@langchain/langgraph` åŒ…ã€‚
>
> å¦‚æœä½ éœ€è¦ä½¿ç”¨ Agentï¼Œè¯·å®‰è£…ï¼š`npm install @langchain/langgraph`

### ä»€ä¹ˆæ˜¯ Agentï¼Ÿ

**Agent** æ˜¯ä¸€ä¸ªæ™ºèƒ½ä»£ç†ï¼Œå®ƒå¯ä»¥ï¼š

1. ğŸ¤” **åˆ†æä»»åŠ¡** - ç†è§£ç”¨æˆ·éœ€æ±‚
2. ğŸ› ï¸ **é€‰æ‹©å·¥å…·** - å†³å®šè°ƒç”¨å“ªäº›å·¥å…·
3. ğŸ”„ **æ‰§è¡Œå¾ªç¯** - è‡ªåŠ¨è°ƒç”¨å·¥å…·ã€è·å–ç»“æœã€å†åˆ†æ
4. ğŸ’¬ **ç”Ÿæˆç­”æ¡ˆ** - æ•´åˆæ‰€æœ‰ä¿¡æ¯ï¼Œç»™å‡ºæœ€ç»ˆå›ç­”

### æ‰‹åŠ¨å®ç° vs Agent

| å¯¹æ¯”é¡¹       | æ‰‹åŠ¨å®ç°ï¼ˆæ¨èå…¥é—¨ï¼‰ | Agentï¼ˆè¿›é˜¶ï¼‰          |
| ------------ | -------------------- | ---------------------- |
| **ä¾èµ–åŒ…**   | `@langchain/core`    | `@langchain/langgraph` |
| **å·¥å…·é€‰æ‹©** | éœ€è¦ä½ ç¼–å†™é€»è¾‘       | AI è‡ªåŠ¨å†³å®š            |
| **å¾ªç¯è°ƒç”¨** | éœ€è¦æ‰‹åŠ¨ç¼–å†™å¾ªç¯     | è‡ªåŠ¨æ‰§è¡Œå¤šè½®è°ƒç”¨       |
| **å­¦ä¹ æ›²çº¿** | ä½ï¼Œæ›´å®¹æ˜“ç†è§£åŸç†   | é«˜ï¼ŒæŠ½è±¡ç¨‹åº¦æ›´é«˜       |
| **é€‚ç”¨åœºæ™¯** | å­¦ä¹ ã€ç®€å•ä»»åŠ¡       | å¤æ‚çš„ç”Ÿäº§åº”ç”¨         |

### å­¦ä¹ å»ºè®®

1. **å…ˆæŒæ¡æ‰‹åŠ¨å®ç°**ï¼šç†è§£å·¥å…·è°ƒç”¨çš„å®Œæ•´æµç¨‹
2. **å†å­¦ä¹  LangGraph**ï¼šç”¨äºæ„å»ºå¤æ‚çš„ Agent åº”ç”¨
3. **å‚è€ƒæ–‡æ¡£**ï¼šhttps://langchain-ai.github.io/langgraphjs/

---

## å®æˆ˜æ¡ˆä¾‹åˆ†æ

### æ¡ˆä¾‹ 1: æ™ºèƒ½å®¢æœåŠ©æ‰‹

**éœ€æ±‚**: åˆ›å»ºä¸€ä¸ªå®¢æœåŠ©æ‰‹ï¼Œå¯ä»¥æŸ¥è¯¢è®¢å•çŠ¶æ€ã€é€€æ¬¾ä¿¡æ¯ã€ç‰©æµä¿¡æ¯ã€‚

```javascript
import { HumanMessage, ToolMessage } from "@langchain/core/messages";
import { DynamicStructuredTool } from "@langchain/core/tools";
import { z } from "zod";

// å·¥å…· 1: æŸ¥è¯¢è®¢å•
const orderTool = new DynamicStructuredTool({
  name: "query_order",
  description: "æŸ¥è¯¢è®¢å•çŠ¶æ€å’Œè¯¦æƒ…",
  schema: z.object({
    order_id: z.string().describe("è®¢å•å·"),
  }),
  func: async ({ order_id }) => {
    // è°ƒç”¨è®¢å•ç³»ç»Ÿ API
    return JSON.stringify({
      order_id: order_id,
      status: "å·²å‘è´§",
      total: 299.0,
      items: ["iPhone æ•°æ®çº¿", "å……ç”µå™¨"],
    });
  },
});

// å·¥å…· 2: æŸ¥è¯¢ç‰©æµ
const logisticsTool = new DynamicStructuredTool({
  name: "query_logistics",
  description: "æŸ¥è¯¢åŒ…è£¹ç‰©æµä¿¡æ¯",
  schema: z.object({
    tracking_number: z.string().describe("ç‰©æµå•å·"),
  }),
  func: async ({ tracking_number }) => {
    return JSON.stringify({
      status: "è¿è¾“ä¸­",
      location: "åŒ—äº¬åˆ†æ‹¨ä¸­å¿ƒ",
      expected_delivery: "2025-12-05",
    });
  },
});

// å·¥å…· 3: ç”³è¯·é€€æ¬¾
const refundTool = new DynamicStructuredTool({
  name: "request_refund",
  description: "ä¸ºè®¢å•ç”³è¯·é€€æ¬¾",
  schema: z.object({
    order_id: z.string().describe("è®¢å•å·"),
    reason: z.string().describe("é€€æ¬¾åŸå› "),
  }),
  func: async ({ order_id, reason }) => {
    // è°ƒç”¨é€€æ¬¾ç³»ç»Ÿ
    return JSON.stringify({
      refund_id: "RF" + Date.now(),
      status: "å·²æäº¤",
      message: "é€€æ¬¾ç”³è¯·å·²æäº¤ï¼Œé¢„è®¡ 3-5 ä¸ªå·¥ä½œæ—¥å¤„ç†å®Œæˆ",
    });
  },
});

// åˆ›å»ºå®¢æœå·¥å…·é›†
const customerServiceTools = [orderTool, logisticsTool, refundTool];
const llmWithCustomerTools = llm.bindTools(customerServiceTools);

// ä½¿ç”¨å®Œæ•´çš„å·¥å…·è°ƒç”¨æµç¨‹
async function customerServiceChat(question) {
  const messages = [new HumanMessage(question)];
  const response = await llmWithCustomerTools.invoke(messages);

  if (response.tool_calls && response.tool_calls.length > 0) {
    messages.push(response);

    for (const toolCall of response.tool_calls) {
      const tool = customerServiceTools.find((t) => t.name === toolCall.name);
      if (tool) {
        const result = await tool.invoke(toolCall.args);
        messages.push(
          new ToolMessage({
            tool_call_id: toolCall.id,
            content: result,
          })
        );
      }
    }

    const finalResponse = await llmWithCustomerTools.invoke(messages);
    return finalResponse.content;
  }

  return response.content;
}

// æµ‹è¯•
await customerServiceChat("æˆ‘çš„è®¢å• 12345 ä»€ä¹ˆæ—¶å€™èƒ½åˆ°ï¼Ÿ");
```

### æ¡ˆä¾‹ 2: æ•°æ®åˆ†æåŠ©æ‰‹

**éœ€æ±‚**: åˆ†æé”€å”®æ•°æ®ï¼Œç”ŸæˆæŠ¥å‘Šã€‚

```javascript
import { HumanMessage, ToolMessage } from "@langchain/core/messages";
import { DynamicStructuredTool } from "@langchain/core/tools";
import { z } from "zod";

// å·¥å…· 1: æŸ¥è¯¢é”€å”®æ•°æ®
const salesDataTool = new DynamicStructuredTool({
  name: "get_sales_data",
  description: "è·å–æŒ‡å®šæ—¶é—´èŒƒå›´çš„é”€å”®æ•°æ®",
  schema: z.object({
    start_date: z.string().describe("å¼€å§‹æ—¥æœŸ YYYY-MM-DD"),
    end_date: z.string().describe("ç»“æŸæ—¥æœŸ YYYY-MM-DD"),
  }),
  func: async ({ start_date, end_date }) => {
    // æŸ¥è¯¢æ•°æ®åº“
    return JSON.stringify([
      { date: "2025-12-01", sales: 15000, orders: 50 },
      { date: "2025-12-02", sales: 18000, orders: 60 },
    ]);
  },
});

// å·¥å…· 2: è®¡ç®—ç»Ÿè®¡æŒ‡æ ‡
const statisticsTool = new DynamicStructuredTool({
  name: "calculate_statistics",
  description: "è®¡ç®—å¹³å‡å€¼ã€æ€»å’Œã€å¢é•¿ç‡ç­‰ç»Ÿè®¡æŒ‡æ ‡",
  schema: z.object({
    data: z.string().describe("JSON æ ¼å¼çš„æ•°æ®æ•°ç»„"),
    metric: z.enum(["average", "sum", "growth_rate"]),
  }),
  func: async ({ data, metric }) => {
    const dataArray = JSON.parse(data);
    // è®¡ç®—é€»è¾‘
    return "ç»Ÿè®¡ç»“æœ...";
  },
});

// åˆ›å»ºæ•°æ®åˆ†æå·¥å…·é›†
const analyticsTools = [salesDataTool, statisticsTool];
const llmWithAnalyticsTools = llm.bindTools(analyticsTools);

// ä½¿ç”¨å·¥å…·è¿›è¡Œæ•°æ®åˆ†æ
async function analyzeData(question) {
  const messages = [new HumanMessage(question)];
  const response = await llmWithAnalyticsTools.invoke(messages);

  if (response.tool_calls && response.tool_calls.length > 0) {
    messages.push(response);

    for (const toolCall of response.tool_calls) {
      const tool = analyticsTools.find((t) => t.name === toolCall.name);
      if (tool) {
        const result = await tool.invoke(toolCall.args);
        messages.push(
          new ToolMessage({
            tool_call_id: toolCall.id,
            content: result,
          })
        );
      }
    }

    const finalResponse = await llmWithAnalyticsTools.invoke(messages);
    return finalResponse.content;
  }

  return response.content;
}

// ä½¿ç”¨ç¤ºä¾‹
await analyzeData("å¸®æˆ‘åˆ†æä¸€ä¸‹ 12 æœˆä»½çš„é”€å”®æƒ…å†µï¼Œè®¡ç®—å¹³å‡é”€å”®é¢å’Œå¢é•¿ç‡");
```

---

## æœ€ä½³å®è·µ

### âœ… 1. ç¼–å†™æ¸…æ™°çš„å·¥å…·æè¿°

**âŒ ä¸å¥½çš„æè¿°**

```javascript
description: "æŸ¥è¯¢å¤©æ°”";
```

**âœ… å¥½çš„æè¿°**

```javascript
description: "è·å–æŒ‡å®šåŸå¸‚çš„å¤©æ°”ä¿¡æ¯ã€‚å½“ç”¨æˆ·è¯¢é—®å¤©æ°”ã€æ¸©åº¦ã€æ˜¯å¦ä¸‹é›¨æ—¶ä½¿ç”¨æ­¤å·¥å…·ã€‚";
```

**ä¸ºä»€ä¹ˆï¼Ÿ**

- æ˜ç¡®çš„æè¿°å¸®åŠ© AI å‡†ç¡®åˆ¤æ–­ä½•æ—¶ä½¿ç”¨å·¥å…·
- åŒ…å«ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### âœ… 2. ä¸ºå‚æ•°æ·»åŠ è¯¦ç»†çš„ describe

**âŒ ä¸å¥½çš„å‚æ•°å®šä¹‰**

```javascript
schema: z.object({
  city: z.string(),
  date: z.string(),
});
```

**âœ… å¥½çš„å‚æ•°å®šä¹‰**

```javascript
schema: z.object({
  city: z.string().describe("åŸå¸‚åç§°ï¼Œä¾‹å¦‚ï¼šåŒ—äº¬ã€ä¸Šæµ·ã€æ·±åœ³"),
  date: z
    .string()
    .optional()
    .describe("æ—¥æœŸï¼Œæ ¼å¼: YYYY-MM-DDã€‚å¦‚æœä¸æä¾›åˆ™æŸ¥è¯¢ä»Šå¤©çš„å¤©æ°”"),
});
```

### âœ… 3. ç»Ÿä¸€è¿”å›æ ¼å¼

**æ¨èè¿”å› JSON å­—ç¬¦ä¸²ï¼š**

```javascript
func: async ({ city }) => {
  const data = await fetchWeather(city);

  // âœ… è¿”å›ç»“æ„åŒ–çš„ JSON
  return JSON.stringify({
    city: city,
    temperature: data.temp,
    condition: data.condition,
    timestamp: new Date().toISOString(),
  });

  // âŒ ä¸è¦è¿”å›éšæ„æ ¼å¼çš„å­—ç¬¦ä¸²
  // return `${city}çš„å¤©æ°”æ˜¯${data.condition}ï¼Œæ¸©åº¦${data.temp}åº¦`;
};
```

### âœ… 4. é”™è¯¯å¤„ç†

```javascript
func: async ({ expression }) => {
  try {
    const result = calculate(expression);
    return JSON.stringify({ success: true, result: result });
  } catch (error) {
    // è¿”å›å‹å¥½çš„é”™è¯¯ä¿¡æ¯
    return JSON.stringify({
      success: false,
      error: "è®¡ç®—å¤±è´¥",
      message: error.message,
    });
  }
};
```

### âœ… 5. ä½¿ç”¨ä½æ¸©åº¦

```javascript
// å·¥å…·è°ƒç”¨æ—¶å»ºè®®ä½¿ç”¨ temperature = 0
const llm = new ChatDeepSeek({
  model: "deepseek-chat",
  temperature: 0, // ç¡®ä¿å·¥å…·é€‰æ‹©çš„ç¡®å®šæ€§
});
```

### âœ… 6. é™åˆ¶å·¥å…·è°ƒç”¨æ·±åº¦

```javascript
// åœ¨æ‰‹åŠ¨å®ç°ä¸­ï¼Œé€šè¿‡è®¡æ•°å™¨é™åˆ¶è°ƒç”¨æ¬¡æ•°
async function chatWithToolsLimited(question, maxIterations = 3) {
  let iteration = 0;
  const messages = [new HumanMessage(question)];

  while (iteration < maxIterations) {
    const response = await llmWithTools.invoke(messages);

    if (!response.tool_calls || response.tool_calls.length === 0) {
      return response.content; // å®Œæˆ
    }

    messages.push(response);

    for (const toolCall of response.tool_calls) {
      const tool = tools.find((t) => t.name === toolCall.name);
      if (tool) {
        const result = await tool.invoke(toolCall.args);
        messages.push(
          new ToolMessage({
            tool_call_id: toolCall.id,
            content: result,
          })
        );
      }
    }

    iteration++;
  }

  return "è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°";
}
```

---

## æŠ€æœ¯åŸç†

### Function Calling (å‡½æ•°è°ƒç”¨)

LangChain Tools åŸºäºå¤§æ¨¡å‹çš„ **Function Calling** èƒ½åŠ›å®ç°ã€‚

#### å·¥ä½œåŸç†

1. **å·¥å…·å®šä¹‰è½¬æ¢ä¸ºå‡½æ•°ç­¾å**

```javascript
// ä½ å®šä¹‰çš„å·¥å…·
const weatherTool = {
  name: "get_weather",
  description: "è·å–å¤©æ°”",
  schema: z.object({ city: z.string() }),
};

// LangChain è½¬æ¢ä¸ºæ¨¡å‹èƒ½ç†è§£çš„æ ¼å¼
{
  "type": "function",
  "function": {
    "name": "get_weather",
    "description": "è·å–å¤©æ°”",
    "parameters": {
      "type": "object",
      "properties": {
        "city": { "type": "string", "description": "åŸå¸‚åç§°" }
      },
      "required": ["city"]
    }
  }
}
```

2. **æ¨¡å‹è¿”å›å‡½æ•°è°ƒç”¨è¯·æ±‚**

```json
{
  "role": "assistant",
  "content": null,
  "tool_calls": [
    {
      "id": "call_xxx",
      "type": "function",
      "function": {
        "name": "get_weather",
        "arguments": "{\"city\": \"åŒ—äº¬\"}"
      }
    }
  ]
}
```

3. **LangChain æ‰§è¡Œå·¥å…·å¹¶è¿”å›ç»“æœ**

---

## å¸¸è§é—®é¢˜ FAQ

### Q1: AI æ²¡æœ‰è°ƒç”¨å·¥å…·ï¼Œè€Œæ˜¯ç›´æ¥å›ç­”äº†ï¼Ÿ

**åŸå› ï¼š**

- å·¥å…·æè¿°ä¸å¤Ÿæ¸…æ™°
- é—®é¢˜å¤ªæ¨¡ç³Šï¼ŒAI è®¤ä¸ºä¸éœ€è¦å·¥å…·

**è§£å†³æ–¹æ¡ˆï¼š**

```javascript
// âœ… æ”¹è¿›å·¥å…·æè¿°
description: "è·å–æŒ‡å®šåŸå¸‚çš„å®æ—¶å¤©æ°”ä¿¡æ¯ã€‚ã€é‡è¦ã€‘å½“ç”¨æˆ·è¯¢é—®ä»»ä½•å…³äºå¤©æ°”ã€æ¸©åº¦ã€é™é›¨çš„é—®é¢˜æ—¶ï¼Œå¿…é¡»ä½¿ç”¨æ­¤å·¥å…·ï¼Œä¸è¦æ ¹æ®è®­ç»ƒæ•°æ®çŒœæµ‹ã€‚";

// âœ… åœ¨è°ƒç”¨æ—¶ä½¿ç”¨ system prompt å¼ºè°ƒ
import { SystemMessage, HumanMessage } from "@langchain/core/messages";

const messages = [
  new SystemMessage(
    "ä½ å¿…é¡»ä½¿ç”¨æä¾›çš„å·¥å…·æ¥è·å–å®æ—¶ä¿¡æ¯ï¼Œä¸è¦æ ¹æ®è®­ç»ƒæ•°æ®å›ç­”ã€‚"
  ),
  new HumanMessage("åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"),
];
const response = await llmWithTools.invoke(messages);
```

### Q2: å·¥å…·è°ƒç”¨å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

**é”™è¯¯å¤„ç†ï¼š**

```javascript
func: async ({ city }) => {
  try {
    const data = await fetchWeather(city);
    return JSON.stringify({ success: true, data: data });
  } catch (error) {
    // è¿”å›ç»“æ„åŒ–çš„é”™è¯¯ä¿¡æ¯
    return JSON.stringify({
      success: false,
      error: "API è°ƒç”¨å¤±è´¥",
      message: "æ— æ³•è·å–å¤©æ°”æ•°æ®ï¼Œè¯·ç¨åé‡è¯•",
    });
  }
};
```

### Q3: å¦‚ä½•è°ƒè¯•å·¥å…·è°ƒç”¨ï¼Ÿ

```javascript
// 1. åœ¨å·¥å…·å‡½æ•°ä¸­æ‰“å°è°ƒè¯•ä¿¡æ¯
func: async (params) => {
  console.log("[DEBUG] å·¥å…·è¢«è°ƒç”¨ï¼Œå‚æ•°:", params);
  const result = await doSomething(params);
  console.log("[DEBUG] å·¥å…·è¿”å›:", result);
  return result;
};

// 2. æ‰“å° AI çš„ tool_calls
const response = await llmWithTools.invoke("åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ");
console.log("AI tool_calls:", JSON.stringify(response.tool_calls, null, 2));

// 3. æ‰‹åŠ¨æµ‹è¯•å·¥å…·ï¼ˆä¸ç»è¿‡ AIï¼‰
const result = await weatherTool.invoke({ city: "åŒ—äº¬" });
console.log("ç›´æ¥è°ƒç”¨ç»“æœ:", result);

// 4. æ‰“å°å®Œæ•´çš„æ¶ˆæ¯æµ
async function debugChatWithTools(question) {
  console.log("=== å¼€å§‹è°ƒè¯• ===");
  const messages = [new HumanMessage(question)];
  console.log("åˆå§‹æ¶ˆæ¯:", messages);

  const response = await llmWithTools.invoke(messages);
  console.log("AI å“åº”:", response);
  console.log("tool_calls:", response.tool_calls);
  // ... ç»§ç»­è°ƒè¯•
}
```

### Q4: å·¥å…·å¤ªå¤šï¼ŒAI é€‰é”™äº†æ€ä¹ˆåŠï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š**

1. **å‡å°‘å·¥å…·æ•°é‡** - æ¯ä¸ª Agent ä¸è¦è¶…è¿‡ 10 ä¸ªå·¥å…·
2. **ä¼˜åŒ–æè¿°** - è®©æ¯ä¸ªå·¥å…·çš„åŠŸèƒ½æ›´æ˜ç¡®
3. **åˆ†ç»„ç®¡ç†** - ä¸ºä¸åŒä»»åŠ¡åˆ›å»ºä¸åŒçš„ Agent

```javascript
// âŒ æ‰€æœ‰å·¥å…·æ”¾åœ¨ä¸€èµ·ï¼ˆè¶…è¿‡ 10 ä¸ªå·¥å…·ï¼‰
const allTools = [
  weatherTool,
  calculatorTool,
  orderTool,
  refundTool,
  logisticsTool,
  databaseTool,
  emailTool,
  searchTool,
  translateTool,
  timeTool, // ... æ›´å¤šå·¥å…·
];

// âœ… æŒ‰åŠŸèƒ½åˆ†ç»„ï¼Œåˆ›å»ºä¸åŒçš„ LLM å®ä¾‹
const customerServiceTools = [orderTool, refundTool, logisticsTool];
const llmForCustomerService = llm.bindTools(customerServiceTools);

const dataAnalysisTools = [databaseTool, calculatorTool, statisticsTool];
const llmForDataAnalysis = llm.bindTools(dataAnalysisTools);
```

### Q5: å¦‚ä½•å®ç°å·¥å…·çš„æƒé™æ§åˆ¶ï¼Ÿ

```javascript
const sensitiveOperationTool = new DynamicStructuredTool({
  name: "delete_user",
  description: "åˆ é™¤ç”¨æˆ·ï¼ˆä»…ç®¡ç†å‘˜å¯ç”¨ï¼‰",
  schema: z.object({
    user_id: z.string(),
    admin_token: z.string().describe("ç®¡ç†å‘˜ä»¤ç‰Œ"),
  }),
  func: async ({ user_id, admin_token }) => {
    // éªŒè¯æƒé™
    if (!verifyAdminToken(admin_token)) {
      return JSON.stringify({
        success: false,
        error: "æƒé™ä¸è¶³",
      });
    }

    // æ‰§è¡Œæ“ä½œ
    await deleteUser(user_id);
    return JSON.stringify({ success: true });
  },
});
```

---

## è¿›é˜¶ä¸»é¢˜

### 1. å·¥å…·çš„ç»„åˆä¸é“¾å¼è°ƒç”¨

```javascript
// åœºæ™¯ï¼šæŸ¥è¯¢å¤©æ°”åï¼Œæ ¹æ®å¤©æ°”æ¨èç©¿è¡£
const weatherTool = new DynamicStructuredTool({
  /* ... */
});
const clothingRecommendationTool = new DynamicStructuredTool({
  name: "recommend_clothing",
  description: "æ ¹æ®å¤©æ°”æ¨èç©¿è¡£",
  schema: z.object({
    temperature: z.number(),
    condition: z.string(),
  }),
  func: async ({ temperature, condition }) => {
    // æ¨èé€»è¾‘
  },
});

// Agent ä¼šè‡ªåŠ¨ï¼š
// 1. è°ƒç”¨ weatherTool è·å–å¤©æ°”
// 2. å°†ç»“æœä¼ ç»™ clothingRecommendationTool
// 3. ç”Ÿæˆæœ€ç»ˆå»ºè®®
```

### 2. æ‰‹åŠ¨å®ç°å¤šè½®å¯¹è¯ï¼ˆä¿å­˜ä¸Šä¸‹æ–‡ï¼‰

```javascript
// ä½¿ç”¨æ•°ç»„ä¿å­˜å¯¹è¯å†å²
const conversationHistory = [];

async function chatWithMemory(question) {
  // æ·»åŠ æ–°çš„ç”¨æˆ·æ¶ˆæ¯
  conversationHistory.push(new HumanMessage(question));

  // è°ƒç”¨ AIï¼ˆåŒ…å«å†å²ä¸Šä¸‹æ–‡ï¼‰
  const response = await llmWithTools.invoke(conversationHistory);

  if (response.tool_calls && response.tool_calls.length > 0) {
    conversationHistory.push(response);

    for (const toolCall of response.tool_calls) {
      const tool = tools.find((t) => t.name === toolCall.name);
      if (tool) {
        const result = await tool.invoke(toolCall.args);
        conversationHistory.push(
          new ToolMessage({
            tool_call_id: toolCall.id,
            content: result,
          })
        );
      }
    }

    const finalResponse = await llmWithTools.invoke(conversationHistory);
    conversationHistory.push(finalResponse);
    return finalResponse.content;
  }

  conversationHistory.push(response);
  return response.content;
}

// å¤šè½®å¯¹è¯ç¤ºä¾‹
await chatWithMemory("æŸ¥è¯¢è®¢å• 12345");
await chatWithMemory("è¿™ä¸ªè®¢å•ä»€ä¹ˆæ—¶å€™å‘è´§çš„ï¼Ÿ"); // AI ä¼šè®°å¾—ä¹‹å‰çš„è®¢å•å·
```

### 3. å®ç°æµå¼å·¥å…·è°ƒç”¨

```javascript
// æ³¨æ„ï¼šå·¥å…·è°ƒç”¨æœ¬èº«é€šå¸¸ä¸æ”¯æŒæµå¼
// ä½†å¯ä»¥åœ¨å·¥å…·ç»“æœè¿”å›åï¼Œæµå¼è¾“å‡ºæœ€ç»ˆå›ç­”

async function streamFinalAnswer(question) {
  const messages = [new HumanMessage(question)];
  const response = await llmWithTools.invoke(messages);

  if (response.tool_calls && response.tool_calls.length > 0) {
    messages.push(response);

    for (const toolCall of response.tool_calls) {
      const tool = tools.find((t) => t.name === toolCall.name);
      if (tool) {
        const result = await tool.invoke(toolCall.args);
        messages.push(
          new ToolMessage({
            tool_call_id: toolCall.id,
            content: result,
          })
        );
      }
    }

    // æµå¼è¾“å‡ºæœ€ç»ˆå›ç­”
    const stream = await llmWithTools.stream(messages);
    for await (const chunk of stream) {
      process.stdout.write(chunk.content || "");
    }
  }
}
```

---

## å­¦ä¹ è·¯å¾„å»ºè®®

### ğŸ“ æœ¬æ–‡é…å¥—å®æˆ˜æ–‡ä»¶

æŒ‰é¡ºåºå®Œæˆä»¥ä¸‹ç»ƒä¹ ï¼Œé€æ­¥æŒæ¡ Tools çš„ä½¿ç”¨ï¼š

| æ–‡ä»¶å                | å†…å®¹                  | é¢„è®¡ç”¨æ—¶ |
| --------------------- | --------------------- | -------- |
| `test-setup.js`       | ç¯å¢ƒéªŒè¯              | 5 åˆ†é’Ÿ   |
| `01-create-tool.js`   | åˆ›å»ºè‡ªå®šä¹‰å·¥å…·        | 15 åˆ†é’Ÿ  |
| `02-bind-tools.js`    | AI è‡ªåŠ¨é€‰æ‹©å·¥å…·       | 20 åˆ†é’Ÿ  |
| `03-tool-loop.js`     | å®Œæ•´å·¥å…·è°ƒç”¨å¾ªç¯      | 30 åˆ†é’Ÿ  |
| `04-tavily-search.js` | TavilySearch çœŸå®æœç´¢ | 20 åˆ†é’Ÿ  |

### ğŸ¯ å­¦ä¹ è·¯çº¿

**ç¬¬ 1 é˜¶æ®µï¼šåŸºç¡€å…¥é—¨ï¼ˆ1 å°æ—¶ï¼‰**

1. âœ… å®Œæˆç¯å¢ƒæ­å»ºï¼Œè¿è¡Œ `test-setup.js`
2. âœ… å®Œæˆ `01-create-tool.js`ï¼Œç†è§£å·¥å…·å››è¦ç´ 
3. âœ… å®Œæˆ `02-bind-tools.js`ï¼Œè§‚å¯Ÿ AI å¦‚ä½•é€‰æ‹©å·¥å…·

**ç¬¬ 2 é˜¶æ®µï¼šæ ¸å¿ƒæŒæ¡ï¼ˆ1-2 å°æ—¶ï¼‰**

1. ğŸ”¥ å®Œæˆ `03-tool-loop.js`ï¼Œç†è§£ ToolMessage çš„ä½œç”¨
2. ğŸ”¥ å°è¯•ä¿®æ”¹å·¥å…·çš„ `description`ï¼Œè§‚å¯Ÿ AI è¡Œä¸ºå˜åŒ–
3. ğŸ”¥ åˆ›å»ºè‡ªå·±çš„å·¥å…·ï¼ˆå¦‚ï¼šéšæœºæ•°ã€å•ä½è½¬æ¢ï¼‰

**ç¬¬ 3 é˜¶æ®µï¼šè¿›é˜¶åº”ç”¨ï¼ˆ2+ å°æ—¶ï¼‰**

1. ğŸ’ æ³¨å†Œ Tavily è´¦å·ï¼Œå®Œæˆ `04-tavily-search.js`
2. ğŸ’ åˆ›å»ºå¤šå·¥å…·åº”ç”¨ï¼ˆå¦‚ï¼šæ™ºèƒ½åŠ©æ‰‹ï¼‰
3. ğŸ’ å­¦ä¹  LangGraph æ„å»ºå¤æ‚ Agent

---

## å®æˆ˜æŒ‘æˆ˜

### ğŸ¥‰ æŒ‘æˆ˜ 1ï¼šåˆ›å»ºå®ç”¨å·¥å…·é›†

åœ¨æŒæ¡åŸºç¡€åï¼Œå°è¯•åˆ›å»ºä»¥ä¸‹å·¥å…·ï¼š

```javascript
// åˆ›å»º 05-my-tools.jsï¼Œå®ç°ä»¥ä¸‹å·¥å…·ï¼š

// 1. éšæœºæ•°ç”Ÿæˆå™¨
const randomTool = new DynamicStructuredTool({
  name: "random",
  description: "ç”Ÿæˆéšæœºæ•°",
  schema: z.object({
    min: z.number().describe("æœ€å°å€¼"),
    max: z.number().describe("æœ€å¤§å€¼"),
  }),
  func: async ({ min, max }) => {
    return String(Math.floor(Math.random() * (max - min + 1)) + min);
  },
});

// 2. å•ä½è½¬æ¢å·¥å…·ï¼ˆæ¸©åº¦ï¼‰
const tempConverterTool = new DynamicStructuredTool({
  name: "convert_temp",
  description: "æ‘„æ°åº¦å’Œåæ°åº¦è½¬æ¢",
  schema: z.object({
    value: z.number(),
    from: z.enum(["C", "F"]),
  }),
  func: async ({ value, from }) => {
    if (from === "C") {
      return `${value}Â°C = ${((value * 9) / 5 + 32).toFixed(1)}Â°F`;
    }
    return `${value}Â°F = ${(((value - 32) * 5) / 9).toFixed(1)}Â°C`;
  },
});

// 3. å­—ç¬¦ä¸²å¤„ç†å·¥å…·
const stringTool = new DynamicStructuredTool({
  name: "string_process",
  description: "å­—ç¬¦ä¸²å¤„ç†ï¼šå¤§å°å†™è½¬æ¢ã€åè½¬ã€Base64ç¼–ç ",
  schema: z.object({
    text: z.string(),
    operation: z.enum(["upper", "lower", "reverse", "base64"]),
  }),
  func: async ({ text, operation }) => {
    switch (operation) {
      case "upper":
        return text.toUpperCase();
      case "lower":
        return text.toLowerCase();
      case "reverse":
        return text.split("").reverse().join("");
      case "base64":
        return Buffer.from(text).toString("base64");
    }
  },
});
```

### ğŸ¥ˆ æŒ‘æˆ˜ 2ï¼šæ™ºèƒ½åŠ©æ‰‹åº”ç”¨

åˆ›å»ºä¸€ä¸ªç»“åˆå¤šä¸ªå·¥å…·çš„æ™ºèƒ½åŠ©æ‰‹ï¼š

```javascript
// åˆ›å»º 06-smart-assistant.js
// ç»“åˆå¤©æ°”ã€æ—¶é—´ã€è®¡ç®—å™¨ã€æœç´¢ç­‰å·¥å…·
// å®ç°ä¸€ä¸ªå¯ä»¥å›ç­”å„ç§é—®é¢˜çš„åŠ©æ‰‹
```

### ğŸ¥‡ æŒ‘æˆ˜ 3ï¼šå¸¦è®°å¿†çš„å¯¹è¯ç³»ç»Ÿ

å‚è€ƒ"è¿›é˜¶ä¸»é¢˜"ç« èŠ‚ï¼Œå®ç°å¤šè½®å¯¹è¯è®°å¿†åŠŸèƒ½ã€‚

### ğŸ’¡ æŒ‘æˆ˜å®Œæˆæ£€éªŒ

å®ŒæˆæŒ‘æˆ˜åï¼Œå°è¯•å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š

1. å·¥å…·çš„ `description` å¯¹ AI çš„å·¥å…·é€‰æ‹©æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ
2. ä¸ºä»€ä¹ˆå·¥å…·å‡½æ•°çš„è¿”å›å€¼å»ºè®®ä½¿ç”¨å­—ç¬¦ä¸²ï¼Ÿ
3. `ToolMessage` çš„ `tool_call_id` ä¸ºä»€ä¹ˆæ˜¯å¿…é¡»çš„ï¼Ÿ
4. å¦‚ä½•è®© AI åœ¨ä¸éœ€è¦å·¥å…·æ—¶ç›´æ¥å›ç­”ï¼Ÿ

---

## å‚è€ƒèµ„æº

### å®˜æ–¹æ–‡æ¡£

- **LangChain Tools å®˜æ–¹æ–‡æ¡£**: https://js.langchain.com/docs/concepts/tools/
- **LangChain å†…ç½®å·¥å…·åˆ—è¡¨**: https://js.langchain.com/docs/integrations/tools
- **LangGraphï¼ˆAgent æ¡†æ¶ï¼‰**: https://langchain-ai.github.io/langgraphjs/
- **Zod Schema éªŒè¯**: https://zod.dev/

### API æœåŠ¡

- **Tavily Search API**: https://tavily.com/ ï¼ˆä¸“ä¸º AI è®¾è®¡çš„æœç´¢å¼•æ“ï¼‰
- **DeepSeek API**: https://platform.deepseek.com/ ï¼ˆé«˜æ€§ä»·æ¯” LLMï¼‰
- **OpenAI Function Calling**: https://platform.openai.com/docs/guides/function-calling

### å¼€å‘å·¥å…·

- **Trae AI IDE**: https://www.trae.ai/ ï¼ˆæ¨èçš„ AI å¼€å‘ç¯å¢ƒï¼‰

---

## æ€»ç»“

### ğŸ¯ æ ¸å¿ƒè¦ç‚¹

1. **Tools è®© AI æ‹¥æœ‰èƒ½åŠ›** - æŸ¥è¯¢æ•°æ®ã€æ‰§è¡Œè®¡ç®—ã€è°ƒç”¨ API
2. **å››è¦ç´ ** - nameã€descriptionã€schemaã€func
3. **ToolMessage** - å°†å·¥å…·ç»“æœä¼ å› AI çš„å…³é”®
4. **å†…ç½®å·¥å…·** - TavilySearch ç­‰ LangChain å®˜æ–¹å·¥å…·å¼€ç®±å³ç”¨
5. **æœ€ä½³å®è·µ** - æ¸…æ™°æè¿°ã€é”™è¯¯å¤„ç†ã€ç»Ÿä¸€æ ¼å¼

### ğŸ’¡ è®°ä½è¿™å¥è¯

> **Tools ä¸æ˜¯è®© AI æ›´èªæ˜ï¼Œè€Œæ˜¯è®© AI èƒ½åšæ›´å¤šäº‹æƒ…ã€‚**

### ğŸ“ æœ¬æ–‡å®æˆ˜æ–‡ä»¶æ¸…å•

å®Œæˆæœ¬æ•™ç¨‹åï¼Œä½ çš„é¡¹ç›®ç»“æ„åº”è¯¥æ˜¯ï¼š

```
langchain-tools-demo/
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ package.json            # é¡¹ç›®é…ç½®
â”œâ”€â”€ test-setup.js           # ç¯å¢ƒéªŒè¯
â”œâ”€â”€ 01-create-tool.js       # å®æˆ˜ç»ƒä¹  1ï¼šåˆ›å»ºå·¥å…·
â”œâ”€â”€ 02-bind-tools.js        # å®æˆ˜ç»ƒä¹  2ï¼šç»‘å®šå·¥å…·
â”œâ”€â”€ 03-tool-loop.js         # å®æˆ˜ç»ƒä¹  3ï¼šå®Œæ•´è°ƒç”¨å¾ªç¯
â”œâ”€â”€ 04-tavily-search.js     # å®æˆ˜ç»ƒä¹  4ï¼šTavilySearch
â”œâ”€â”€ 05-my-tools.js          # æŒ‘æˆ˜ 1ï¼šè‡ªå®šä¹‰å·¥å…·é›†
â””â”€â”€ 06-smart-assistant.js   # æŒ‘æˆ˜ 2ï¼šæ™ºèƒ½åŠ©æ‰‹
```

### ğŸ”‘ å…³é”®æ”¶è·

å­¦å®Œæœ¬æ–‡åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

- âœ… ä½¿ç”¨ Trae æ­å»º LangChain å¼€å‘ç¯å¢ƒ
- âœ… ç†è§£ Tools çš„å·¥ä½œåŸç†å’Œä½¿ç”¨åœºæ™¯
- âœ… åˆ›å»ºè‡ªå®šä¹‰å·¥å…·å¹¶ç»‘å®šåˆ° LLM
- âœ… å®ç°å®Œæ•´çš„å·¥å…·è°ƒç”¨å¾ªç¯ï¼ˆåŒ…æ‹¬ ToolMessageï¼‰
- âœ… ä½¿ç”¨ TavilySearch å®ç°çœŸå®çš„äº’è”ç½‘æœç´¢
- âœ… è°ƒè¯•å·¥å…·è°ƒç”¨é—®é¢˜å¹¶è¿›è¡Œä¼˜åŒ–

---

## ä½œè€…å¯„è¯­

æ„Ÿè°¢ä½ é˜…è¯»è¿™ä»½æ–‡æ¡£ï¼LangChain Tools æ˜¯ AI åº”ç”¨å¼€å‘ä¸­æœ€å®ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå¸Œæœ›è¿™ä»½è¯¦è§£èƒ½å¸®åŠ©ä½ å¿«é€Ÿä¸Šæ‰‹ã€‚

**åŠ¨æ‰‹å®è·µæ˜¯æœ€å¥½çš„å­¦ä¹ æ–¹å¼ï¼** ä¸è¦åªæ˜¯é˜…è¯»ï¼Œè¯·æŒ‰ç…§æ–‡ä¸­çš„å®æˆ˜ç»ƒä¹ ä¸€æ­¥æ­¥æ“ä½œï¼Œä½ ä¼šå‘ç° Tools å…¶å®å¾ˆç®€å•ã€‚

å¦‚æœä½ åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š

- ğŸ’¬ åœ¨ Trae ä¸­è¯¢é—® AI åŠ©æ‰‹ï¼Œå®ƒèƒ½ç›´æ¥é˜…è¯»ä½ çš„ä»£ç å¸®ä½ æ’æŸ¥é—®é¢˜
- ğŸ“– æŸ¥é˜… [LangChain å®˜æ–¹æ–‡æ¡£](https://js.langchain.com/docs/concepts/tools/)
- ğŸ” ä½¿ç”¨ TavilySearch æœç´¢æœ€æ–°çš„è§£å†³æ–¹æ¡ˆ

å¦‚æœä½ è§‰å¾—è¿™ä»½æ–‡æ¡£å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ï¼š

- â­ ç‚¹èµæ”¶è—ï¼Œæ–¹ä¾¿ä»¥åæŸ¥é˜…
- ğŸ“¢ åˆ†äº«ç»™æ›´å¤šæ­£åœ¨å­¦ä¹  AI å¼€å‘çš„æœ‹å‹
- ğŸ’¬ åœ¨è¯„è®ºåŒºäº¤æµä½ çš„å­¦ä¹ å¿ƒå¾—å’Œå®è·µæˆæœ

**Happy Coding!** ğŸš€
